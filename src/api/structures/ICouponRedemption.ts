import { tags } from "typia";

/**
 * 쿠폰 사용 이력 엔티티 (coupon_redemptions)입니다.
 *
 * [프로모션·적립금 설계, 쿠폰 실시간 사용/배정 추적, 사기탐지, 탈퇴/히스토리 명세]와 관련된 주요 엔티티입니다.
 *
 * - 각 이력은 단일 쿠폰, 단일 사용자, 특정 상태값(배정, 클레임, 사용, 만료, 취소 등) 및 관련 타임스탬프를 보유.
 * - 법적 준수(불가침 이력, 영구 감사/재발굴 지원)와 마케팅 분석(누적, 사용자별), AI 기반 리스크 관리(사기 탐지)에도 활발히
 *   활용됩니다.
 *
 * Prisma 스키마 주석을 기반으로 필드별로 원자적 속성을 세밀히 나눠 설계되었습니다.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type ICouponRedemption = {
  /**
   * 고유 식별자입니다. 쿠폰 사용 이력 테이블의 기본키로 활용됩니다. Prisma coupon_redemptions.id 참조.
   *
   * 이 값은 각 사용/배정 기록을 구분하며, 관련된 타 엔티티(쿠폰, 사용자)와의 연계에 사용합니다.
   */
  id: string & tags.Format<"uuid">;

  /**
   * 적용된 쿠폰의 고유 ID입니다. Prisma coupon_redemptions.coupon_id.
   *
   * 해당 사용/배정 기록이 어떤 쿠폰에 대한 것인지를 명확하게 연결합니다.
   */
  coupon_id: string & tags.Format<"uuid">;

  /**
   * 쿠폰을 소유하거나 사용하는 사용자의 고유 ID입니다. Prisma coupon_redemptions.user_id 참조.
   *
   * 마케팅 타겟팅, 중복 사용 방지, 컴플라이언스 추적 용도로 활용됩니다.
   */
  user_id: string & tags.Format<"uuid">;

  /**
   * 쿠폰 이력의 상태(예: assigned/claimed/redeemed/expired/cancelled 등). Prisma
   * coupon_redemptions.status 참조.
   *
   * 상태 값은 비즈니스 룰(유효, 만료, 사용됨 등)을 반영하며, 적절한 워크플로우 제어 및 상태 변경 관리(관리자/고객센터 대응
   * 등)을 위해 필수적입니다.
   */
  status: string;

  /**
   * 쿠폰이 사용자에게 배정된 시간(있을 경우). Prisma coupon_redemptions.assigned_at 참조.
   *
   * 캠페인 배포, 개별 지급 이벤트, 배정내역 분석 용도에 사용됩니다. Null일 수 있습니다.
   */
  assigned_at?: (string & tags.Format<"date-time">) | null;

  /**
   * 쿠폰을 실제로 사용자가 명시적으로 획득(클레임)한 시각(있을 경우). Prisma
   * coupon_redemptions.claimed_at 참조.
   *
   * 특정 프로모션/선착순 이벤트/수동 등록 등에서 시간 기준 분쟁 해결 및 클레임 트래킹에 사용합니다.
   */
  claimed_at?: (string & tags.Format<"date-time">) | null;

  /**
   * 쿠폰이 주문 등에서 실제로 사용(적용)된 시각입니다. Prisma coupon_redemptions.redeemed_at 참조.
   *
   * 각 이력의 효력 발생 시점/재정산 및 회계(환불, 차감, 적립 등) 기준을 확정합니다.
   */
  redeemed_at?: (string & tags.Format<"date-time">) | null;

  /**
   * 쿠폰 이력 만료 시각(만료된 경우). Prisma coupon_redemptions.expired_at.
   *
   * 법적 감시, 고객 문의(왜 사용 불가?), 잔여쿠폰 분석 등을 위함입니다.
   */
  expired_at?: (string & tags.Format<"date-time">) | null;

  /**
   * AI/ML 기반 사기탐지 레코드 참조키(있을 경우). Prisma coupon_redemptions.fraud_check_id.
   *
   * 이 값이 있으면, 해당 쿠폰 이력이 사기/이상 징후에 대해 분석, AI 기반 설명(Explainable AI) 및 감사 용도로 추가
   * 기록과 연결됨을 의미합니다.
   */
  fraud_check_id?: (string & tags.Format<"uuid">) | null;
};
export namespace ICouponRedemption {
  /**
   * Search/filter options for coupon redemption query. References
   * coupon_redemptions Prisma entity. RBAC logic enforced by server
   * side—optional user_id filter allows customer/user self-query.
   */
  export type IRequest = {
    /** Filter by coupon (UUID). */
    coupon_id?: string & tags.Format<"uuid">;

    /** Show only redemptions by specific user. */
    user_id?: string & tags.Format<"uuid">;

    /** Redemption state filter: assigned, claimed, redeemed, expired, etc. */
    status?: string;

    /** Lower bound for redemption time, ISO8601. */
    redeemed_from?: string & tags.Format<"date-time">;

    /** Upper bound for redemption (inclusive), ISO8601. */
    redeemed_to?: string & tags.Format<"date-time">;

    /** Sort by (e.g., redeemed_at, assigned_at, coupon_id, etc.). */
    sortBy?: string;

    /** Sort asc/desc. */
    sortDirection?: "asc" | "desc";

    /** Pagination page 1-based. */
    page?: number & tags.Type<"int32">;

    /** Page size for results. */
    pageSize?: number & tags.Type<"int32">;
  };

  /**
   * 쿠폰 사용 이력 신규 생성 요청 타입입니다.
   *
   * - 업무 API에서 쿠폰 발급·클레임·배정 시 사용.
   * - 중복 발급 방지, 사용자별 자동 이벤트 배정, AI 사기탐지 사전 로깅 등에 모두 활용.
   */
  export type ICreate = {
    /**
     * 발급 또는 사용할 쿠폰의 고유 ID. 필수.
     *
     * 쿠폰 선택/클레임/캠페인 배정 시 단일 쿠폰 참조키입니다.
     */
    coupon_id: string & tags.Format<"uuid">;

    /**
     * 혜택을 받을 사용자의 고유 ID. 보안/감사 용도로 필수.
     *
     * 중복 발급, 사기방지, 타 시스템 연계 시 핵심 식별키입니다.
     */
    user_id: string & tags.Format<"uuid">;

    /**
     * 초기 이력 상태(assigned, claimed, redeemed, expired, cancelled 중 하나).
     * 비즈니스워크플로우 룰에 따라 지정.
     *
     * 필수.
     */
    status: string;

    /**
     * 배정 시간. 자동 입력 혹은 외부/관리자 지정 가능.
     *
     * 클레임/쿠폰 발급 이벤트에서 사용되며, null 허용.
     */
    assigned_at?: (string & tags.Format<"date-time">) | null;
  };

  /**
   * 쿠폰 사용 이력(CouponRedemption) 갱신/수정용 요청 타입(부분 필드 갱신 가능).
   *
   * - 워크플로우 상태변경, 만료 처리, 사기탐지 연동 등의 비즈니스 규칙과 연동됨.
   */
  export type IUpdate = {
    /**
     * 쿠폰 이력 상태(assigned, claimed, redeemed, expired, cancelled 등). 변경 시
     * 비즈니스 정책과 워크플로우(예: 취소, 만료처리, 재적립 정책 등) 트리거.
     *
     * 예: 발급→사용, 사용→취소 등에서 업데이트.
     */
    status?: string;

    /** 실제 사용 일시를 갱신(사용 완료 등록, 회수 등). */
    redeemed_at?: (string & tags.Format<"date-time">) | null;

    /** 만료 또는 취소 등으로 SLA 만료 시각 업데이트. null 가능. */
    expired_at?: (string & tags.Format<"date-time">) | null;

    /** AI/ML 사기탐지 이력의 참조 ID. */
    fraud_check_id?: (string & tags.Format<"uuid">) | null;
  };
}

import { tags } from "typia";

/**
 * MetricExport(메트릭 대시보드 내보내기 이벤트 및 파일) 엔티티.
 *
 * Analytics_dashboard 등과 직접적으로 연결되어 있는 대시보드 내보내기 로그/이력, 각 기록은 추출이나 다운로드, 자동화된
 * 지표 보고 등에도 활용됩니다. 파일 위치, 포맷, 요청/실행 수단, 요청/생성 타임스탬프, 액터 정보를 모두 포함, 삭제된 이력에도
 * 불변성을 지킴.
 *
 * Compliance: 실제 데이터는 삭제 불가로, soft-delete로 deleted_at만 관리함. RBAC 정책에 따라 요청자 및
 * 대시보드별 가시성 제어.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IMetricExport = {
  /** 고유 Export ID. */
  id: string & tags.Format<"uuid">;

  /** 대상 AnalyticsDashboard의 PK. 내보내기/다운로드의 근거가 되는 대시보드 식별자. */
  dashboard_id: string & tags.Format<"uuid">;

  /** 내보내기/다운로드 포맷(CSV/JSON/PDF 등). */
  export_format: string;

  /** 내보내기 시점의 설정 및 필터링, KPI 등 컨텍스트 정보(JSON 등 직렬화 문자열). */
  configuration: string;

  /** 다운로드 혹은 API 추출된 파일 절대 경로, Signed URL/Direct URL 지원. */
  export_file_url: string;

  /** 실제 내보내기/다운로드 시각. */
  export_time: string & tags.Format<"date-time">;

  /** 내보내기 요청자(관리자/사용자 PK 등) */
  requested_by: string & tags.Format<"uuid">;

  /** Soft-delete 삭제 시점(필수: 실제 삭제 불가 원칙). */
  deleted_at?: (string & tags.Format<"date-time">) | null;
};
export namespace IMetricExport {
  /**
   * MetricExport(메트릭 대시보드 내보내기 기록) 목록 조회 요청 DTO.
   *
   * 프리즈마 metric_export 엔터티에 기반, 특정 대시보드, 사용자, 포맷, 시간 조건 등 복합 필터와 페이징 필요. RBAC
   * 및 관리자/담당자별 권한 필터, 대시보드/유저/타입/기간 조건 쿼리 등 운영/감사/분석 목적을 모두 만족시킵니다.
   */
  export type IRequest = {
    /** 복합 키/범위/포맷/상태 등 다양한 필터링 정보. */
    filter?: {
      /** 대시보드 식별자(필터) */
      dashboard_id?: (string & tags.Format<"uuid">) | null;

      /** 요청자(유저/admin/seller 등) PK. */
      requested_by?: (string & tags.Format<"uuid">) | null;

      /** 내보내기 포맷(CSV, JSON, PDF, 등) */
      export_format?: string | null;

      /** 내보내기 시작일(이상) */
      export_time_from?: (string & tags.Format<"date-time">) | null;

      /** 내보내기 종료일(이하) */
      export_time_to?: (string & tags.Format<"date-time">) | null;
    };

    /** 정렬 필드 (default: export_time desc 등) */
    sort?: string | null;

    /** 정렬 방향(asc/desc) */
    order?: "asc" | "desc";

    /** 페이지 번호 */
    page?: number & tags.Type<"int32"> & tags.Default<1> & tags.Minimum<1>;

    /** 페이지별 항목 개수 */
    limit?: number &
      tags.Type<"int32"> &
      tags.Default<20> &
      tags.Minimum<1> &
      tags.Maximum<100>;
  };

  /**
   * MetricExport(대시보드 메트릭 내보내기) 생성 요청 DTO.
   *
   * 대시보드 기반 CSV/JSON/PDF 등 export 이벤트 등록 시 사용되며, 파일/포맷/요청자/시점/설정값 등이 필수입니다.
   * RBAC에 의해 관리자가 대표적으로 활용하며, 요청자/대상/파일 위치/포맷이 모두 저장됩니다.
   */
  export type ICreate = {
    /** Export 대시보드 식별자(PK UUID). */
    dashboard_id: string & tags.Format<"uuid">;

    /** CSV/JSON/PDF 등 내보내기 포맷. */
    export_format: string;

    /** 내보내기 시점의 상세 설정값 (필터, 컬럼, 차트 등 직렬화 JSON) */
    configuration: string;

    /** 실제 결과 파일 CDN/S3 URL 또는 배포 경로. */
    export_file_url: string;

    /** 내보내기(다운로드) 실행 시각. */
    export_time: string & tags.Format<"date-time">;

    /** 요청자(관리자/사용자 PK) */
    requested_by: string & tags.Format<"uuid">;
  };

  /**
   * 메트릭 내보내기(엑스포트) 엔티티의 업데이트 타입입니다.
   *
   * 내보내기 포맷, 내보내기 환경 구성(JSON), 결과 파일 URL을 변경할 수 있습니다. 대시보드 내보내기, 컴플라이언스 리포트
   * 등에서 사용합니다. 각 필드는 metric_export 테이블 컬럼과 정확히 매핑되며, 상세 감사 로그와 재현성을 보장하기 위해
   * 필드 설명 및 예시가 포함되어 있습니다.
   */
  export type IUpdate = {
    /**
     * 내보내기 포맷 필드입니다.
     *
     * 내보내기 포맷(예: CSV, JSON, PDF 등)을 지정합니다. 데이터 내보내기의 형식을 정의하는 데 사용됩니다.
     * (Prisma: metric_export.export_format)
     *
     * 필수 필드이며, 지원되는 포맷 값만 허용됩니다. 예시: "csv", "json", "pdf" 등.
     */
    export_format: string;

    /**
     * 내보내기 시점의 대시보드/필터/메트릭 등 구성을 JSON 문자열로 저장합니다.
     *
     * 데이터 내보내기 설정(필터, 메트릭 집합 등)을 보존해 재현성과 컴플라이언스 감사를 보장합니다. (Prisma:
     * metric_export.configuration)
     *
     * 필수입니다. 예시: '{"metrics": ["sales", "conversion_rate"], "date_range":
     * "2025-01-01~2025-02-01"}'.
     */
    configuration: string;

    /**
     * 내보내기된 파일의 URL입니다.
     *
     * CDN/오브젝트 스토어의 파일 위치를 지정하며, 감사, 다운로드, 검증을 위해 사용합니다. (Prisma:
     * metric_export.export_file_url)
     *
     * 최대 80000자. 필수 필드. 파일 접근 보안을 위한 서명 URL 일 수 있습니다.
     */
    export_file_url: string & tags.Format<"uri">;
  };
}

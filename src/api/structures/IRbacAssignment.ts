import { tags } from "typia";

/**
 * RBAC 할당(assignment) 단일 이력 엔티티 타입. rbac_assignments(Prisma) 테이블의 모든 컬럼과 업무 규칙
 * 및 요구사항 (정책 감사, 정책 할당, 유효기간/스코프 관리 등)까지 완전히 반영해야 합니다.
 *
 * 각 필드별로 외부 엔티티(User, Role, Permission 등과의 관계), 스코프, 유효 만료일, 생성 시간 등이 모두 명확하게
 * 기술되어야 하며, 정책/감사상 표시 가능한 모든 정보를 포함합니다.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IRbacAssignment = {
  /** RBAC 할당 이력의 PK. rbac_assignments.id 컬럼. */
  id: string & tags.Format<"uuid">;

  /** 권한이 부여된 사용자 PK. 반드시 users.id(Prisma) 참조. */
  user_id: string & tags.Format<"uuid">;

  /** 연결된 역할 role의 id. rbac_roles.id 참조. */
  role_id: string & tags.Format<"uuid">;

  /** 연결된 permission의 id. rbac_permissions.id 참조. */
  permission_id: string & tags.Format<"uuid">;

  /** 채널 한정 스코프. rbac_assignments.scope_channel_id 참조. null이면 전체 채널. */
  scope_channel_id?: string & tags.Format<"uuid">;

  /** 섹션 한정 스코프. rbac_assignments.scope_section_id 참조. null이면 전체 섹션. */
  scope_section_id?: string & tags.Format<"uuid">;

  /** 할당 만료일(구조상 null이면 영구 할당). rbac_assignments.expires_at 컬럼. */
  expires_at?: string & tags.Format<"date-time">;

  /** 할당 레코드 생성 시점. rbac_assignments.created_at. */
  created_at: string & tags.Format<"date-time">;
};
export namespace IRbacAssignment {
  /**
   * RBAC 할당(assignment) 검색/목록 조회를 위한 요청 DTO. RBAC 역할/권한 이력, 감사, 정책 관리 및 대규모
   * 정책 조회에 활용.
   *
   * Prisma rbac_assignments 테이블의 각 컬럼별 3NF 원자적 속성 필터를 인자로 갖습니다.
   *
   * 검색/필터/정렬/페이지네이션 전부를 지원하며, 업무 요구 및 테이블 주석에 표기된 용례를 모두 반영해야 합니다.
   */
  export type IRequestSearch = {
    /**
     * 검색 필터: 지정 사용자(user)의 RBAC 할당 레코드만 검색. rbac_assignments.user_id와 일치.
     * RBAC 감사/추적에 활용.
     */
    user_id?: string & tags.Format<"uuid">;

    /** 검색 필터: 지정 역할(role)에 대한 할당만 조회. rbac_assignments.role_id 컬럼 필터용. */
    role_id?: string & tags.Format<"uuid">;

    /**
     * 검색 필터: 특정 permission 할당 레코드만 조회. rbac_assignments.permission_id 컬럼
     * 기준.
     */
    permission_id?: string & tags.Format<"uuid">;

    /** 검색 필터: 채널 스코프에 한정되는 RBAC 할당만 검색. rbac_assignments.scope_channel_id. */
    scope_channel_id?: string & tags.Format<"uuid">;

    /** 검색 필터: 섹션 스코프의 RBAC 할당만 검색. rbac_assignments.scope_section_id. */
    scope_section_id?: string & tags.Format<"uuid">;

    /** 할당 만료일(이후) 기준 필터. rbac_assignments.expires_at를 ISO 날짜로 평가. */
    expires_after?: string & tags.Format<"date-time">;

    /** 할당 만료일(이전) 기준 필터. 만료되기 전, 만료되는 할당만 조회. */
    expires_before?: string & tags.Format<"date-time">;

    /** 생성 시점(이후) 필터. rbac_assignments.created_at 컬럼 기준. */
    created_after?: string & tags.Format<"date-time">;

    /** 생성 시점(이전) 필터. rbac_assignments.created_at 컬럼 기준. */
    created_before?: string & tags.Format<"date-time">;

    /** 정렬 기준 필드. created_at, expires_at, user_id 등 지원. */
    sort_by?: "created_at" | "expires_at" | "user_id";

    /** 정렬 방향. asc/desc 중 지정. 기본 desc. */
    sort_dir?: "asc" | "desc";

    /** 페이지 번호(0/1부터 시작, 기본 1) */
    page?: number & tags.Type<"int32"> & tags.Minimum<1>;

    /** 페이지당 결과 갯수. 기본 20, 최대 100. */
    limit?: number & tags.Type<"int32"> & tags.Minimum<1> & tags.Maximum<100>;
  };

  /**
   * RBAC 할당 생성 요청 DTO. rbac_assignments의 모든 컬럼에 대한 생성/할당 업무 규칙을 포괄함.
   *
   * User_id, role_id, permission_id 필드는 필수. scope_channel_id,
   * scope_section_id, expires_at는 선택적이며 정책에 따라 할당 범위 및 만료 지정에 활용.
   *
   * 정책 배포 및 정책 기반 접근제어 시스템의 핵심 엔티티.
   */
  export type ICreate = {
    /** 권한을 부여할 사용자 id. users.id 참조. */
    user_id: string & tags.Format<"uuid">;

    /** 할당 대상 역할 id. rbac_roles.id. */
    role_id: string & tags.Format<"uuid">;

    /** 할당할 권한 id. rbac_permissions.id 참조. */
    permission_id: string & tags.Format<"uuid">;

    /** 채널 스코프 id. null이면 제한 없음. */
    scope_channel_id?: string & tags.Format<"uuid">;

    /** 섹션 스코프 id. null이면 제한 없음. */
    scope_section_id?: string & tags.Format<"uuid">;

    /** 할당 만료 시점. 없으면 영구 할당. */
    expires_at?: string & tags.Format<"date-time">;
  };

  /**
   * RBAC 할당 이력 업데이트용 DTO. rbac_assignments(Prisma)의 수정 가능한 컬럼에 한해 update. 정책
   * 만료일, 역할/권한/스코프만 변경 가능. PK/user_id 변경 불가 정책 준수.
   */
  export type IUpdate = {
    /** 수정할 역할 id. rbac_roles.id 참조. */
    role_id?: string & tags.Format<"uuid">;

    /** 수정할 권한 id. rbac_permissions.id 참조. */
    permission_id?: string & tags.Format<"uuid">;

    /** 수정할 채널 스코프 id (변경 시에만 입력). */
    scope_channel_id?: string & tags.Format<"uuid">;

    /** 수정할 섹션 스코프 id (변경 시에만 입력). */
    scope_section_id?: string & tags.Format<"uuid">;

    /** 변경 유효 기간 만료 시점. */
    expires_at?: string & tags.Format<"date-time">;
  };
}

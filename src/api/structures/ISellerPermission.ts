import { tags } from "typia";

/**
 * 판매자에 대한 세부 권한 할당 정보를 표현합니다.
 *
 * Seller_permissions 테이블 행 atomic record 기준.
 *
 * - 각 행은 개별 권한의 부여 이력
 * - Seller/관리자/코드/부여시점/만료일, soft-delete 등 기록
 * - RBAC/온보딩/권한 감사에서 활용
 *
 * 상세 필드를 통해 seller의 실제 권한 범위 추적, 권한 회수/설정 등의 다양한 작업 기반으로 사용됨.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type ISellerPermission = {
  /** 판매자 권한 레코드 고유 ID */
  id: string & tags.Format<"uuid">;

  /** 권한이 부여된 seller의 id */
  seller_id: string & tags.Format<"uuid">;

  /** 권한을 부여한 관리자(admins.id) FK */
  granted_by_admin_id: string & tags.Format<"uuid">;

  /** 권한 코드, 예: 'product_add', 'see_analytics', 'board_manage' */
  permission_code: string;

  /** 권한 부여일시 */
  granted_at: string & tags.Format<"date-time">;

  /** 권한의 임시 부여기간이 있을 경우 만료일시(영구라면 null) */
  expires_at?: (string & tags.Format<"date-time">) | null;

  /** 소프트 삭제 시 삭제일시, 회수된 경우 */
  deleted_at?: (string & tags.Format<"date-time">) | null;

  /** 현재 권한의 상태(유효함/만료/회수됨 등), 예: 'active', 'revoked', 'expired' */
  status: string;
};
export namespace ISellerPermission {
  /**
   * 판매자 개별 권한 목록 검색/필터/페이징 쿼리 DTO
   *
   * Seller_permissions 테이블의 권한 부여/승인/관리/감사 목록을 목록단위로 조회할 때 사용하는 구조.
   *
   * - Seller_id 등 판매자단위 필터링
   * - Permission_code, granted_by_admin 등 업무 필드 검색
   * - 페이지네이션용 limit, offset, sort 등
   *
   * 관리자 대시보드나 RBAC 관리화면에서 활용합니다.
   */
  export type IRequest = {
    /**
     * 특정 판매자에 한정해서 검색할 경우 사용.
     *
     * Seller_permissions.seller_id
     */
    seller_id?: string & tags.Format<"uuid">;

    /**
     * 권한 코드별(예: 'sale_analytics', 'product_add', 'export') 검색 필터.
     * seller_permissions.permission_code
     */
    permission_code?: string;

    /** 해당 권한 부여 주체(관리자ID)로 필터링 할 때 사용. */
    granted_by_admin_id?: string & tags.Format<"uuid">;

    /**
     * 지정 기간 내에 부여/발급된 권한만 조회할 때 사용하는 시작일시.
     *
     * '-'로 입력시 전체
     */
    from_date?: string & tags.Format<"date-time">;

    /** 지정 기간 내 끝일시. 없으면 현재까지 */
    to_date?: string & tags.Format<"date-time">;
  };

  /**
   * 판매자 권한 신규 부여/등록 입력용 DTO.
   *
   * RBAC 엔진/관리자/온보딩에서 seller에게 업무별 권한을 할당할 때 사용. 입력값 validation 및 권한 코드 유효성,
   * 유일성 확인 필요.
   *
   * 주로 admin 시스템, RBAC 정책, 셀러 온보딩, 임시권한(shadow role) 부여 플로우에 활용.
   *
   * Prisma 주석: 필수값만 포함.
   */
  export type ICreate = {
    /** 권한을 부여할 seller id. sellers.id FK */
    seller_id: string & tags.Format<"uuid">;

    /** 권한을 부여하는 관리자(admins.id) FK */
    granted_by_admin_id: string & tags.Format<"uuid">;

    /** 부여할 권한 코드. ENUM 정책 시스템에서 관리됨 */
    permission_code: string;

    /** 임시/기간 제한 권한일 경우 만료일시(없으면 영구) */
    expires_at?: (string & tags.Format<"date-time">) | null;
  };

  /**
   * 판매자 권한 기록 수정/만료/회수 입력용 DTO
   *
   * 기존 할당된 판매자 권한(Individual Permission) 레코드의 정보 수정, 만료 처리, 권한코드 변경 등 관리
   * 플로우에서 사용.
   *
   * Admin 정책상 권한 회수 시 deleted_at 설정, expires_at 갱신, permission_code 변경(필요 시),
   * granted_by_admin 변경(특별상황) 등이 주요 타겟 필드임.
   *
   * Prisma/정책상 수정할 수 있는 필드만 정의됨.
   */
  export type IUpdate = {
    /** 권한 코드(변경될 경우). */
    permission_code?: string;

    /** 만료일시를 변경할 때 사용. */
    expires_at?: (string & tags.Format<"date-time">) | null;

    /** 권한 회수/삭제시 soft delete. 수동만료/특정상황에서만 사용. */
    deleted_at?: (string & tags.Format<"date-time">) | null;

    /** 상태변경(유효·회수·만료 등). */
    status?: string;
  };
}
